# bag organizer
# Run the script and select the bag
# where you want your items. It will
# find all the items it supports and
# neatly place them for you.
setvar sort_bag
#
# Aspect cores
#
overhead 'Sorting Aspect Cores' 88
while findtype 'aspect core' sort_bag as item
    getlabel item desc
    if 'Air' in desc
        lift item 9999
        drop sort_bag 45 65
        wait 600
        ignore item
    endif
    if 'Artisan' in desc
        lift item 9999
        drop sort_bag 55 65
        wait 600
        ignore item
    endif
    if 'Blood' in desc
        lift item 9999
        drop sort_bag 65 65
        wait 600
        ignore item
    endif
    if 'Command' in desc
        lift item 9999
        drop sort_bag 75 65
        wait 600
        ignore item
    endif
    if 'Death' in desc
        lift item 9999
        drop sort_bag 85 65
        wait 600
        ignore item
    endif
    if 'Discipline' in desc
        lift item 9999
        drop sort_bag 95 65
        wait 600
        ignore item
    endif
    if 'Earth' in desc
        lift item 9999
        drop sort_bag 105 65
        wait 600
        ignore item
    endif
    if 'Eldritch' in desc
        lift item 9999
        drop sort_bag 115 65
        wait 600
        ignore item
    endif
    if 'Fire' in desc
        lift item 9999
        drop sort_bag 125 65
        wait 600
        ignore item
    endif
    if 'Fortune' in desc
        lift item 9999
        drop sort_bag 135 65
        wait 600
        ignore item
    endif
    if 'Gadget' in desc
        lift item 9999
        drop sort_bag 145 65
        wait 600
        ignore item
    endif
    if 'Harvest' in desc
        lift item 9999
        drop sort_bag 155 65
        wait 600
        ignore item
    endif
    if 'Holy' in desc
        lift item 9999
        drop sort_bag 45 80
        wait 600
        ignore item
    endif
    if 'Lyric' in desc
        lift item 9999
        drop sort_bag 55 80
        wait 600
        ignore item
    endif
    if 'Poison' in desc
        lift item 9999
        drop sort_bag 65 80
        wait 600
        ignore item
    endif
    if 'Shadow' in desc
        lift item 9999
        drop sort_bag 75 80
        wait 600
        ignore item
    endif
    if 'Void' in desc
        lift item 9999
        drop sort_bag 85 80
        wait 600
        ignore item
    endif
    if 'War' in desc
        lift item 9999
        drop sort_bag 95 80
        wait 600
        ignore item
    endif
    if 'Water' in desc
        lift item 9999
        drop sort_bag 105 80
        wait 600
        ignore item
    endif
    ignore item
endwhile

#
# Aspect distillations
#
overhead 'Sorting Aspect Distillations' 88
while findtype 'flask' sort_bag as item
    getlabel item desc
    if 'Air' in desc
        lift item 9999
        drop sort_bag 45 95
        wait 600
        ignore item
    endif
    if 'Artisan' in desc
        lift item 9999
        drop sort_bag 55 95
        wait 600
        ignore item
    endif
    if 'Blood' in desc
        lift item 9999
        drop sort_bag 65 95
        wait 600
        ignore item
    endif
    if 'Command' in desc
        lift item 9999
        drop sort_bag 75 95
        wait 600
        ignore item
    endif
    if 'Death' in desc
        lift item 9999
        drop sort_bag 85 95
        wait 600
        ignore item
    endif
    if 'Discipline' in desc
        lift item 9999
        drop sort_bag 95 95
        wait 600
        ignore item
    endif
    if 'Earth' in desc
        lift item 9999
        drop sort_bag 105 95
        wait 600
        ignore item
    endif
    if 'Eldritch' in desc
        lift item 9999
        drop sort_bag 115 95
        wait 600
        ignore item
    endif
    if 'Fire' in desc
        lift item 9999
        drop sort_bag 125 95
        wait 600
        ignore item
    endif
    if 'Fortune' in desc
        lift item 9999
        drop sort_bag 135 95
        wait 600
        ignore item
    endif
    if 'Gadget' in desc
        lift item 9999
        drop sort_bag 145 95
        wait 600
        ignore item
    endif
    if 'Harvest' in desc
        lift item 9999
        drop sort_bag 155 95
        wait 600
        ignore item
    endif
    if 'Holy' in desc
        lift item 9999
        drop sort_bag 45 115
        wait 600
        ignore item
    endif
    if 'Lyric' in desc
        lift item 9999
        drop sort_bag 55 115
        wait 600
        ignore item
    endif
    if 'Poison' in desc
        lift item 9999
        drop sort_bag 65 115
        wait 600
        ignore item
    endif
    if 'Shadow' in desc
        lift item 9999
        drop sort_bag 75 115
        wait 600
        ignore item
    endif
    if 'Void' in desc
        lift item 9999
        drop sort_bag 85 115
        wait 600
        ignore item
    endif
    if 'War' in desc
        lift item 9999
        drop sort_bag 95 115
        wait 600
        ignore item
    endif
    if 'Water' in desc
        lift item 9999
        drop sort_bag 105 115
        wait 600
        ignore item
    endif
    ignore item
endwhile

#
# Phylacteries
#
overhead 'Sorting Aspect Phylacteries' 88
while findtype 'phylactery' sort_bag as item
    getlabel item desc
    if 'air' in desc
        lift item 9999
        drop sort_bag 45 65
        wait 600
        ignore item
    endif
    if 'artisan' in desc
        lift item 9999
        drop sort_bag 55 65
        wait 600
        ignore item
    endif
    if 'blood' in desc
        lift item 9999
        drop sort_bag 65 65
        wait 600
        ignore item
    endif
    if 'command' in desc
        lift item 9999
        drop sort_bag 75 65
        wait 600
        ignore item
    endif
    if 'death' in desc
        lift item 9999
        drop sort_bag 85 65
        wait 600
        ignore item
    endif
    if 'discipline' in desc
        lift item 9999
        drop sort_bag 95 65
        wait 600
        ignore item
    endif
    if 'earth' in desc
        lift item 9999
        drop sort_bag 105 65
        wait 600
        ignore item
    endif
    if 'eldritch' in desc
        lift item 9999
        drop sort_bag 115 65
        wait 600
        ignore item
    endif
    if 'fire' in desc
        lift item 9999
        drop sort_bag 125 65
        wait 600
        ignore item
    endif
    if 'fortune' in desc
        lift item 9999
        drop sort_bag 135 65
        wait 600
        ignore item
    endif
    if 'gadget' in desc
        lift item 9999
        drop sort_bag 145 65
        wait 600
        ignore item
    endif
    if 'harvest' in desc
        lift item 9999
        drop sort_bag 155 65
        wait 600
        ignore item
    endif
    if 'holy' in desc
        lift item 9999
        drop sort_bag 45 80
        wait 600
        ignore item
    endif
    if 'lyric' in desc
        lift item 9999
        drop sort_bag 55 80
        wait 600
        ignore item
    endif
    if 'poison' in desc
        lift item 9999
        drop sort_bag 65 80
        wait 600
        ignore item
    endif
    if 'shadow' in desc
        lift item 9999
        drop sort_bag 75 80
        wait 600
        ignore item
    endif
    if 'void' in desc
        lift item 9999
        drop sort_bag 85 80
        wait 600
        ignore item
    endif
    if 'war' in desc
        lift item 9999
        drop sort_bag 95 80
        wait 600
        ignore item
    endif
    if 'water' in desc
        lift item 9999
        drop sort_bag 105 80
        wait 600
        ignore item
    endif
    ignore item
endwhile

#
# Skill scrolls
#
if not listexists coord_x
    createlist coord_x
else
    clearlist coord_x
endif
pushlist coord_x 45
pushlist coord_x 55
pushlist coord_x 65
pushlist coord_x 75
pushlist coord_x 85
pushlist coord_x 95
pushlist coord_x 105
pushlist coord_x 115
pushlist coord_x 125
pushlist coord_x 135
pushlist coord_x 145
pushlist coord_x 155
pushlist coord_x 45
pushlist coord_x 55
pushlist coord_x 65
pushlist coord_x 75
pushlist coord_x 85
pushlist coord_x 95
pushlist coord_x 105

if not listexists coord_y
    createlist coord_y
else
    clearlist coord_y
endif
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 65
pushlist coord_y 80
pushlist coord_y 80
pushlist coord_y 80
pushlist coord_y 80
pushlist coord_y 80
pushlist coord_y 80
pushlist coord_y 80

overhead 'Sorting Skill Scrolls' 88
while findtype 'scroll of calling' sort_bag as item
    getlabel item desc
    if 'skill mastery scroll' in desc
        if poplist coord_x front as x
            if poplist coord_y front as y
                lift item 9999
                drop sort_bag x y
                wait 600
                ignore item
            endif
        endif
    endif
    ignore item
endwhile


#
# Treasure maps
#
overhead 'Sorting Treasure Maps' 88
if not listexists map_names
    createlist map_names
else
    clearlist map_names
endif
pushlist map_names 'level 1'
pushlist map_names 'level 2'
pushlist map_names 'level 3'
pushlist map_names 'level 4'
#pushlist map_names 'level 5'
#pushlist map_names 'level 6'
#pushlist map_names 'level 7'
#pushlist map_names 'level 8'

if not listexists coord_y
    createlist coord_y
else
    clearlist coord_y
endif
pushlist coord_y 65
pushlist coord_y 85
pushlist coord_y 105
pushlist coord_y 125
#pushlist coord_y 135
#pushlist coord_y 145
#pushlist coord_y 155
#pushlist coord_y 165

if not listexists coord_x
    createlist coord_x
else
    clearlist coord_x
endif
pushlist coord_x 45
pushlist coord_x 50
pushlist coord_x 55
pushlist coord_x 60
pushlist coord_x 65
pushlist coord_x 70
pushlist coord_x 75
pushlist coord_x 80
pushlist coord_x 85
pushlist coord_x 90
pushlist coord_x 95
pushlist coord_x 100
pushlist coord_x 105
pushlist coord_x 110
pushlist coord_x 115
pushlist coord_x 120
pushlist coord_x 125
pushlist coord_x 130
pushlist coord_x 135

foreach map_name in map_names
    if poplist coord_y front as y
        while findtype 'map' sort_bag as item
            getlabel item desc
            if map_name in desc
                if poplist coord_x front as x
                    lift item 9999
                    drop sort_bag x y
                    wait 600
                    ignore item
                endif
            endif
            ignore item
        endwhile
    endif
    clearignore
    if not listexists coord_x
        createlist coord_x
    else
        clearlist coord_x
    endif
    pushlist coord_x 45
    pushlist coord_x 50
    pushlist coord_x 55
    pushlist coord_x 60
    pushlist coord_x 65
    pushlist coord_x 70
    pushlist coord_x 75
    pushlist coord_x 80
    pushlist coord_x 85
    pushlist coord_x 90
    pushlist coord_x 95
    pushlist coord_x 100
    pushlist coord_x 105
    pushlist coord_x 110
    pushlist coord_x 115
    pushlist coord_x 120
    pushlist coord_x 125
    pushlist coord_x 130
    pushlist coord_x 135 
endfor

#
# Material maps
#
overhead 'Sorting Material Maps' 88
if not listexists map_names
    createlist map_names
else
    clearlist map_names
endif
pushlist map_names 'skinning'
pushlist map_names 'fishing'
pushlist map_names 'ore'
pushlist map_names 'lumber'

if not listexists coord_y
    createlist coord_y
else
    clearlist coord_y
endif
pushlist coord_y 65
pushlist coord_y 85
pushlist coord_y 105
pushlist coord_y 125

if not listexists coord_x
    createlist coord_x
else
    clearlist coord_x
endif
pushlist coord_x 45
pushlist coord_x 50
pushlist coord_x 55
pushlist coord_x 60
pushlist coord_x 65
pushlist coord_x 70
pushlist coord_x 75
pushlist coord_x 80
pushlist coord_x 85
pushlist coord_x 90
pushlist coord_x 95
pushlist coord_x 100
pushlist coord_x 105
pushlist coord_x 110
pushlist coord_x 115
pushlist coord_x 120
pushlist coord_x 125
pushlist coord_x 130
pushlist coord_x 135

foreach map_name in map_names
    if poplist coord_y front as y
        while findtype 'map' sort_bag as item
            getlabel item desc
            if map_name in desc
                if poplist coord_x front as x
                    lift item 9999
                    drop sort_bag x y
                    wait 600
                    ignore item
                endif
            endif
            ignore item
        endwhile
    endif
    clearignore
    if not listexists coord_x
        createlist coord_x
    else
        clearlist coord_x
    endif
    pushlist coord_x 45
    pushlist coord_x 50
    pushlist coord_x 55
    pushlist coord_x 60
    pushlist coord_x 65
    pushlist coord_x 70
    pushlist coord_x 75
    pushlist coord_x 80
    pushlist coord_x 85
    pushlist coord_x 90
    pushlist coord_x 95
    pushlist coord_x 100
    pushlist coord_x 105
    pushlist coord_x 110
    pushlist coord_x 115
    pushlist coord_x 120
    pushlist coord_x 125
    pushlist coord_x 130
    pushlist coord_x 135 
endfor
    
clearignore