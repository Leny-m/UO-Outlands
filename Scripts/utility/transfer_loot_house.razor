# made by Doughmaker (OneMoreKnight#1326)
# restock - 1 = 10 x recall
setvar storage_shelf 0x45FA236B
setvar resource_stockpile 0x59AED00A
setvar bank_safe 0x4F987CF9
setvar core_bag 0x41259355
setvar map_bag 0x43C1EAA0
setvar dye_bag 0x43735ED8
setvar resource_bag 0x4D90556B
setvar unidentified_bag 0x4ED58B65
setvar main_loot_chest 0x4908A425
setvar recall_container 0x4908A425

setvar force_update 0

clearignore 
useskill 'hiding'
wait 100

#
# Main loot chest
#
if not listexists main_loot_chest_types or force_update = 1
    createlist main_loot_chest_types
    pushlist main_loot_chest_types 'Recall'
    # lesser paragon chest
    pushlist main_loot_chest_types '3712'
    # paragon chest
    pushlist main_loot_chest_types '3650'
endif

#
# Bank safe
#
if not listexists bank_safe_types or force_update = 1
    createlist bank_safe_types
    pushlist bank_safe_types 'gold coin'
endif

#
# Core bag
#
if not listexists core_bag_types or force_update = 1
    createlist core_bag_types
    # aspect core
    pushlist core_bag_types '3985'
    # skill scroll
    pushlist core_bag_types '8826'
    # skill mastery orb
    pushlist core_bag_types '22336'
    # phylactery
    pushlist core_bag_types '576'
    # Arcane Scroll 
    pushlist core_bag_types '3827' 
    # plant chemicals
    pushlist core_bag_types '29030'
    # extract
    pushlist core_bag_types '3836'
    # MCD
    pushlist core_bag_types '17087'
    # Distillation
    pushlist core_bag_types 'flask'
endif

#
# Map bag
#
if not listexists map_bag_types or force_update = 1
    createlist map_bag_types
    # research materials
    pushlist map_bag_types '29348'
    # map
    pushlist map_bag_types 'map'
endif

#
# Dye bag
#
if not listexists dye_bag_types or force_update = 1
    createlist dye_bag_types
    # carpet dye
    pushlist dye_bag_types '29036' 
    # runebook dye
    pushlist dye_bag_types '3838'
    # headwear dye
    pushlist dye_bag_types '3842'
    # hair dye
    pushlist dye_bag_types '3843'
    pushlist dye_bag_types 'seed of renewal'
    pushlist dye_bag_types 'folded cloth'
    pushlist dye_bag_types 'rune'
endif

#
# Resource bag
#
if not listexists resource_bag_types or force_update = 1
    createlist resource_bag_types
    # leather
    pushlist resource_bag_types '4225'
    # meat
    pushlist resource_bag_types '2545'
    # any log
    pushlist resource_bag_types '7133'
    # gems
    pushlist resource_bag_types 'amethyst%s%'
    pushlist resource_bag_types 'emerald%s%'
    pushlist resource_bag_types 'citrine%s%'
    pushlist resource_bag_types 'piece%s% of amber'
    pushlist resource_bag_types 'sapphire%s%'
    pushlist resource_bag_types 'star sapphire%s%'
    pushlist resource_bag_types 'diamond%s%'
    pushlist resource_bag_types 'rub%ies/y%'
    pushlist resource_bag_types 'tourmaline%s%'
endif

#
# Unidentified bag
#
if not listexists item_types_magic or force_update = 1
    createlist item_types_magic
    pushlist item_types_magic "martial arts scroll"
    pushlist item_types_magic "halberd"
    pushlist item_types_magic "bardiche"
    pushlist item_types_magic "battle axe"
    pushlist item_types_magic "double axe"
    pushlist item_types_magic "two handed axe"
    pushlist item_types_magic "executioner's axe"
    pushlist item_types_magic "large battle axe"
    pushlist item_types_magic "axe"
    pushlist item_types_magic "scimitar"
    pushlist item_types_magic "longsword"
    pushlist item_types_magic "viking sword"
    pushlist item_types_magic "katana"
    pushlist item_types_magic "cutlass"
    pushlist item_types_magic "broadsword"
    pushlist item_types_magic "war hammer"
    pushlist item_types_magic "war axe"
    pushlist item_types_magic "maul"
    pushlist item_types_magic "quarter staff"
    pushlist item_types_magic "gnarled staff"
    pushlist item_types_magic "black staff"
    pushlist item_types_magic "hammer pick"
    pushlist item_types_magic "club"
    pushlist item_types_magic "shepherd's crook"
    pushlist item_types_magic "war mace"
    pushlist item_types_magic "mace"
    pushlist item_types_magic "Long Spear"
    pushlist item_types_magic "pitchfork"
    pushlist item_types_magic "war fork"
    pushlist item_types_magic "kryss"
    pushlist item_types_magic "short spear"
    pushlist item_types_magic "bow"
    pushlist item_types_magic "crossbow"
    pushlist item_types_magic "heavy crossbow"
    pushlist item_types_magic "bladed staff"
    pushlist item_types_magic "leather tunic"
    pushlist item_types_magic "leather leggings"
    pushlist item_types_magic "leather sleeves"
    pushlist item_types_magic "leather cap"
    pushlist item_types_magic "leather gloves"
    pushlist item_types_magic "leather gorget"
    pushlist item_types_magic "leather armor"
    pushlist item_types_magic "leather bustier"
    pushlist item_types_magic "leather shorts"
    pushlist item_types_magic "leather skirt"
    pushlist item_types_magic "studded tunic"
    pushlist item_types_magic "studded leggings"
    pushlist item_types_magic "studded sleeves"
    pushlist item_types_magic "studded gloves "
    pushlist item_types_magic "studded gorget"
    pushlist item_types_magic "studded armor"
    pushlist item_types_magic "studded bustier"
    pushlist item_types_magic "bone armor"
    pushlist item_types_magic "bone legs"
    pushlist item_types_magic "bone arms"
    pushlist item_types_magic "bone helmet"
    pushlist item_types_magic "bone gloves"
    pushlist item_types_magic "ringmail tunic"
    pushlist item_types_magic "ringmail leggings"
    pushlist item_types_magic "ringmail sleeves"
    pushlist item_types_magic "helmet"
    pushlist item_types_magic "ringmail gloves"
    pushlist item_types_magic "orc helm"
    pushlist item_types_magic "chainmail tunic"
    pushlist item_types_magic "chainmail leggings"
    pushlist item_types_magic "chainmail coif"
    pushlist item_types_magic "platemail"
    pushlist item_types_magic "platemail legs"
    pushlist item_types_magic "platemail arms"
    pushlist item_types_magic "plate helm"
    pushlist item_types_magic "platemail gloves"
    pushlist item_types_magic "platemail gorget"
    pushlist item_types_magic "plate armor"
    pushlist item_types_magic "bascinet"
    pushlist item_types_magic "close helm"
    pushlist item_types_magic "norse helm"
    pushlist item_types_magic "wooden shield"
    pushlist item_types_magic "kite shield"
    pushlist item_types_magic "buckler "
    pushlist item_types_magic "metal shield"
    pushlist item_types_magic "bronze shield"
    pushlist item_types_magic "kite shield"
    pushlist item_types_magic "heater shield"
    pushlist item_types_magic "Chaos shield"
    pushlist item_types_magic "Order shield"
    pushlist item_types_magic "lap harp"
    pushlist item_types_magic "drum"
    pushlist item_types_magic "lute"
    pushlist item_types_magic "bamboo flute"
    pushlist item_types_magic "tambourine"
    pushlist item_types_magic "spellbook"
    pushlist item_types_magic "wand"
    pushlist item_types_magic "3571"
    pushlist item_types_magic "slayer wand"
    pushlist item_types_magic "studded gloves"
endif

# saw
#pushlist item_types_loot '4148'
# tinker tools
#pushlist item_types_loot '7864'
# sewing kit
#pushlist item_types_loot '3997'
# lockpicks
#pushlist item_types_loot '5373'
# drill
#pushlist item_types_loot '29001'

# resource stockpile interaction
dclick resource_stockpile
waitforgump 1859005118
gumpresponse 2
wft
target 'self'
waitforgump 1859005118

# storage shelf interaction
dclick storage_shelf
waitforgump 3232825965
gumpresponse 4
wft
target 'self'
waitforgump 3232825965
gumpresponse 7
waitforgump 3232825965

overhead 'Main loot chest' 77
foreach item_type in main_loot_chest_types
    while findtype item_type backpack as item
        lift item 9999
        drop main_loot_chest -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Bank safe' 77
foreach item_type in bank_safe_types
    while findtype item_type backpack as item
        lift item 9999
        drop bank_safe -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Core bag' 77
foreach item_type in core_bag_types
    while findtype item_type backpack as item
        lift item 9999
        drop core_bag -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Map bag' 77
foreach item_type in map_bag_types
    while findtype item_type backpack as item
        lift item 9999
        drop map_bag -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Dye bag' 77
foreach item_type in dye_bag_types
    while findtype item_type backpack as item
        lift item 9999
        drop dye_bag -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Resource bag' 77
foreach item_type in resource_bag_types
    while findtype item_type backpack as item
        lift item 9999
        drop resource_bag -1 -1 0
        wait 500
    endwhile
endfor

overhead 'Unidentified bag' 77
foreach item_type in item_types_magic
    while findtype item_type backpack as item
        getlabel item description
        if unidentified in description
            lift item 9999
            drop unidentified_bag -1 -1 0
            wait 500
        else
            ignore item
        endif
    endwhile
endfor

overhead 'Recalls -> Runebook' 77
restock 1
wft 1000
target recall_container
wait 1500
if findtype '8012' backpack as recalls
    if findtype '8901' backpack as runebook
        lift recalls 10
        wait 750
        drop runebook
        wait 750
    endif
endif
if findtype '8012' backpack as recalls
    lift recalls 10
    wait 750
    drop recall_container -1 -1 -1
    wait 750
endif

overhead 'Done!' 77